[Volver al inicio](../../index.md)

### 1. Preparación de la máquina y configuración de la red
Desde la interfaz de VirtualBox añade un segundo adaptador de red en modo red solo anfitrión

Indica la dirección IP que asigna VirtualBox a este adaptador de red, así como la dirección IP del adaptador correspondiente en la máquina anfitrión

Le asigna la direccion 192.168.56.102

Comprueba que hay conectividad entre el anfitrión y la máquina virtual.

Para ello hacemos un ping a la ip de la maquina.
````
C:\Users\David>ping 192.168.56.102

Haciendo ping a 192.168.56.102 con 32 bytes de datos:
Respuesta desde 192.168.56.102: bytes=32 tiempo<1m TTL=64
Respuesta desde 192.168.56.102: bytes=32 tiempo<1m TTL=64
Respuesta desde 192.168.56.102: bytes=32 tiempo<1m TTL=64
Respuesta desde 192.168.56.102: bytes=32 tiempo<1m TTL=64

````
Cambia el hostname de Ubuntu para que se llame {iniciales}_server. Esta operación la tienes que realizar directamente en el sistema, no mediante Vagrant.
Para esto iremos al directorio etc
````
david@aso:/$ cd etc
`````
Una vez en este directorio, tendremos que modificar el fichero hostname .
````
david@aso:/etc$ sudo nano hostname
````
Realiza los cambios necesarios en tu equipo Windows para que te resuelva localmente el nombre del servidor Ubuntu (si tienes dudas, en los recursos tienes una breve explicación de cómo hacerlo)

Para que nuestro equipo resuelva la ip tenemos que abrir el cmd como administrador e ir a C:\Windows\System32\drivers\etc y aqui modificaremos el fichero hosts añadiendo la ip y el nombre que le daremos, una vez lo tengamos guardamos los cambios.
![alt text](image.png)
````
PS C:\Users\David> ping servidor_ssh
Haciendo ping a servidor_ssh [192.168.56.102] con 32 bytes de datos:
Respuesta desde 192.168.56.102: bytes=32 tiempo=1ms TTL=64
Respuesta desde 192.168.56.102: bytes=32 tiempo=3ms TTL=64
Respuesta desde 192.168.56.102: bytes=32 tiempo=1ms TTL=64

Estadísticas de ping para 192.168.56.102:
    Paquetes: enviados = 3, recibidos = 3, perdidos = 0
    (0% perdidos),
````


### 2. Creación del usuario y conexión SSH

Crea en Ubuntu un usuario que se llamará {iniciales}_ssh, donde iniciales son las de tu nombre y apellidos
````
root@dmvssh:/# adduser dmv_ssh
````

Realiza los pasos necesarios para que este usurio se pueda conectar mediante SSH mediante contraseña.

Primero le damos permisos.
````
david@dmvssh:/$ sudo usermod -aG sudo dmv_ssh
````

Ahora instalamos el openssh-server para podernos conectar.
````
dmv_ssh@dmvssh:/$ sudo apt install openssh-server
````

Ahora desde nuestro equipo nos intentaremos conectar al usuario
````
PS C:\Users\David> ssh dmv_ssh@192.168.56.102
````

Una vez que hayas verificado que la conexión funciona haz los cambios necesarios para que la conexión se realize mediante un par de claves pública-privada de forma transparente para el usuario.

Para generar un par de claves usaremos el comando ssh-keygen -b 1024, las claves se guardaran en el directorio .ssh, las claves las generaremos desde el equipo cliente y le enviaremos la publica al servidor.
````
PS C:\Users\David> ssh-keygen -b 1024
Generating public/private ed25519 key pair.
Enter file in which to save the key (C:\Users\David/.ssh/id_ed25519):
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in C:\Users\David/.ssh/id_ed25519
Your public key has been saved in C:\Users\David/.ssh/id_ed25519.pub
The key fingerprint is:
SHA256:zBcy9VDnvO8flW7gLh9GTOgzsW1cMokgCAnCd+/KUbo david@DESKTOP-72N6QEO
The key's randomart image is:
+--[ED25519 256]--+
|o...o .. .o.. .  |
|.. o o  ...oo+.  |
|  . . . o .+.=o. |
|       = o..B +..|
|      + S .= B...|
|     o . .  * o..|
|    . +      + +.|
|     E     .o o..|
|            oo  +|
+----[SHA256]-----+
````

Ahora para enviar la clave publica al servidor usaremos el comando 
````
PS C:\Users\David\.ssh> scp ./id_ed25519.pub david@192.168.56.102:id_ed25519.remote.pub
david@192.168.56.102's password:
id_ed25519.pub                                       100%  104   101.6KB/s   00:00
PS C:\Users\David\.ssh>
````
Una vez hecho esto hay que mover la clave al directorio 
authorized_keys.
````
david@dmvssh:~$ cd .ssh
david@dmvssh:~/.ssh$ ls
authorized_keys  id_ed25519  id_ed25519.pub
david@dmvssh:~/.ssh$ nano authorized_keys
````
Ahora al entrar nos pedira que introduzcamos la passphrase que le asignamos 
````
PS C:\Users\David> ssh david@192.168.56.102
Enter passphrase for key 'C:\Users\David/.ssh/id_ed25519':
````

### 3. Conexión transparente a Github
Ahora que ya estás cómodo con la autenticación mediante par de claves pública-privada, intenta configurar tu Github para que te puedas conectar sin necesidad de introducir tu contraseña. Como pista, tienes que acceder a tu perfil -> Settings -> SSH and GPG keys

Una vez estemos en SSH and GPG keys, clicaremos en new ssh key y copimamos la clave publica.