[Volver al inicio](../../index.md)

### 1. Permisos de usuarios

Crea el directorio pr0201 dentro de tu directorio personal y dentro de él crea los directorios dir1 y dir2 ¿Cuáles son los permisos del directorio dir1? No pongas una captura, explica quiénes tienen permisos sobre el directorio y qué pueden hacer en él.

````

david@aso:/home$ sudo mkdir pr0201
````

Entraremos en el directorio creado con cd y una vez hecho esto crearemos el dir1.
````
david@aso:/home/pr0201$ sudo mkdir dir1
````
Ahora mismo solo tienen permisos el usuario root que se encuentra en el grupo root y tiene permisos de lectura, ecritura y ejecución.

Por ultimo creamos dir2 dentro de dir1
````
david@aso:/home/pr0201/dir1$ sudo mkdir dir2
````
Utilizando la notación simbólica, elimina todos los permisos de escritura (propietario, grupo, otros) del directorio dir2

Para esto usamos los siguientes comandos:
 
 Con este comando borramos el los permisos del grupo:
````
david@aso:/home/pr0201$ sudo chmod g-w dir2
````
Usando la opcion o eliminamos los permisos de, resto de usuarios.
````
david@aso:/home/pr0201$ sudo chmod o-w dir2
````


Utilizando la notación octal, elimina el permiso de lectura del directorio dir2, al resto de los usuarios.
chmod 551 dir2


¿Cuáles son ahora los permisos asociados a dir2?
Ahora tiene permisos de lectura y escritura.

Crear bajo dir2, un directorio llamado dir21.
No podemos crearlo ya q no tenemos permisos.

Concédete a ti mismo permiso de escritura en el directorio dir2 e intenta de nuevo el paso anterior.
````
sudo chmod u+w dir2
sudo mkdir dir21
````


### 1. Notación octal y simbólica

- rwxrwxr-x : sudo chmod u+x,g+wx,o+x ~/file
- rwxr--r-- : sudo chmod u+x ~/file
- r--r----- : sudo chmod u-w,o-r ~/file
- rwxr-xr-x : sudo chmod u+x,g+x,o+x ~/file
- rwxr-xr-x : sudo chmod a+x ~/file
- r-x--x--x : sudo chmod u-w,u+x,g-r,o-r,g+x,o+x ~/file
- -w-r----x : sudo  chmod u-r,o-r,o+x ~/file
- -----xrwx : sudo  chmod u-rw,g-r,g+x,o+x,o+w ~/file
- r---w---x : sudo u-w,g-r,g+w,o-r,o+x  chmod ~/file
- -w------- : sudo  chmod u-r,g-r,o-r ~/file
- rw-r----- : sudo chmod o-r ~/file
- rwx--x--x : sudo chmod u+x,g-r,g+x,o-r,o+x ~/file


Escribe el comando que necesitarías para establecer los siguientes permisos en el fichero anterior utilizando notación octal.
rwx rwx rwx :sudo 777 chmod  ~/file
- --x --x --x :sudo chmod 111 ~/file
- r-- -w- --x :sudo chmod 421 ~/file
- -w- --- --- :sudo chmod 200 ~/file
- rw- r-- --- :sudo chmod 640 ~/file
- rwx --x --x :sudo chmod 711 ~/file
- rwx r-x r-x :sudo chmod 755 ~/file
- r-x --x --x :sudo chmod 511 ~/file
- -w- r-- --x :sudo chmod 241 ~/file
- --- --x rwx :sudo chmod 017~/file



### 3. El bit setgid

Crea un grupo llamado asir y los usuarios {iniciales}1 e {iniciales}2, donde {iniciales} son las iniciales de tu nombre. Por ejemplo, en mi caso se llamarían vjgr1 y vjgr2. Haz que los usuarios pertenezcan al grupo.

Creamos el grupo.
````
david@aso:/$ sudo groupadd asir
````
Creamos los usuarios.
````
david@aso:/$ sudo adduser dmv1
david@aso:/$ sudo adduser dmv2
````

Añadimos los usuarios al grupo
````
sudo usermod -G asir dmv1
sudo usermod -G asir dmv2
````
Usamos el comando ```` tail /etc/group ```` para ver que los usuarios se han añadido al grupo correctamente.

Crea el directorio /compartido y asigna propietario: root como usuario propietario y asir como grupo propietario.

````
sudo mkdir compartido
````
Para cambiarlo de grupo y de usuario utilizamos el comando
````
david@aso:~$ sudo chown root:asir compartido
````
````
david@aso:/$ ls -l
total 4
drwxr-xr-x 2 root asir 4096 Oct  3 07:41 compartido
david@aso:~$
````

Asigna al directorio creado permisos de lectura, escritura y ejecución para el usuario y el grupo propietario. El resto de usuarios no tendrá ningún tipo de permiso.
````
david@aso:~$ sudo chmod 771 compartido
````



Establece el bit setgid en el directorio y verifica que se haya asignado.

Para establecer el bit setgid hay que usar el comando:
````
david@aso:~$ sudo chmod g+s compartido
````
Y para comprobar que esta bien hay que usar ````  ls -l```` y ver que se ha añadido una s a los permisos del grupo
````
david@aso:~$ ls -l
total 4
drwxrws--x 2 root asir 4096 Oct  3 07:41 compartido
````

Inicia sesión con usuario1, accede al directorio y crea un fichero llamado fichero1 con algo de contenido. Comprueba los permisos del fichero que has creado.

Para darle permisos de superusuario hay que usar el comando
````
david@aso:/$sudo usermod -aG sudo dmv1
david@aso:/$sudo usermod -aG sudo dmv2
````
Una vez creado el archivo vemos los permisos que tiene el archivo.
````
dmv1@aso:/compartido$ touch fichero1
dmv1@aso:/compartido$ ls -l
total 4
-rw-rw-r-- 1 dmv1 asir 20 Oct  6 11:49 fichero1
````


Ahora inicia sesión con usuario2 y comprueba si puedes acceder a /compartido/fichero1 y si puedes añadirle contenido.
````
dmv2@aso:/$ cd compartido
dmv2@aso:/compartido$
dmv2@aso:/compartido$ nano fichero1
````

Responde las siguientes preguntas:
¿Qué ventajas tiene usar el bit setgid en entornos colaborativos?
Los usuarios que se encuentran en el grupo pueden modificar los archivos que estan el diretorio en el que se activa el setgid, por lo que faliclita el trabajo en equipo.

¿Qué sucede si no se aplica el bit setgid en un entorno colaborativo?
Solo lo podria modificar el pripietario del archivo y es mas complicada la administracion ya que habria a cambiar los permisos manualmente .


### 4. El sticky bit
hora vamos a practicar con el sticky bit. Realiza los siguientes pasos:

Crea el directorio /compartido con todos los permisos para todos los usuarios.

Para esto usaremos los siguientes comandos.
````
david@aso:/$ sudo mkdir compartido
david@aso:/$ sudo chmod 777 compartido
````

Crea dos usuarios {iniciales}1 e {iniciales}2
````
david@aso:/$ sudo adduser dmv1
david@aso:/$ sudo adduser dmv2

````


Vamos a probar primero el funcionamiento sin el sticky bit. Inicia sesión con el primer usuario, crea un fichero y luego, con el segundo usuario, intenta eliminarlo.

````
dmv1@aso:/$ sudo touch fichero1
dmv2@aso:/$ sudo rm fichero1
````

Ahora establece el sticky bit en el directorio y verifica que se ve en los permisos

Para establecer el sticky bit y verficar los permisos hay que usar los siguientes comandos.
````
david@aso:/$ sudo chmod +t compartido
david@aso:/$ ls -ld compartido
drwxrwxrwt 2 root root 4096 Oct  7 17:20 compartido
````

Vuelve a iniciar sesión con el primer usuario, crea un fichero e intenta eliminarlo con el segundo usuario.

````
dmv1@aso:/compartido$ sudo touch fichero_Sticky
dmv2@aso:/compartido$ rm fichero_sticky
rm: remove write-protected regular empty file 'fichero_sticky'?
````

Responde las siguientes preguntas:
¿Qué efecto tiene el sticky bit en un directorio?
Hace que solamente puedan cambiar de nombre o borrar los ficheros dentro del directorio el propietario de ese archivo o el ususario root.

Si tienes habilitado el sticky bit, ¿cómo tendrías que hacer para eliminar un fichero dentro del directorio?
Elevar los permisos a root o cambiar al usuario propietario.